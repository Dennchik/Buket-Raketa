import{g as I,a as x,b as M}from"./vendors/vendor-Cp5wc69_.js";function T(l){window.onload=function(){document.querySelector(l).classList.add("preloader-remove"),document.documentElement.classList.add("loaded")}}I.registerPlugin(x,M);function P(){x.create({wrapper:"#wrapper",content:"#content",speed:1,smooth:1,effects:!0,smoothTouch:.1})}function D(){let l=[],r=document.querySelectorAll("[data-da]"),d=[],p=[];if(r.length>0){let s=0;for(let o=0;o<r.length;o++){const t=r[o],a=t.getAttribute("data-da"),i=t.hasAttribute("data-da-position")?t.getAttribute("data-da-position"):"last",c=t.hasAttribute("data-da-resolution")?t.getAttribute("data-da-resolution"):768;t.setAttribute("data-da-index",s),l[s]={parent:t.parentNode,index:m(t)},d[s]={element:t,destination:document.querySelector("."+a),place:i,breakpoint:c},s++}f(d);for(let o=0;o<d.length;o++){const a=d[o].breakpoint,c=window.matchMedia(`(max-width: ${a}px)`);p.push(c),c.addEventListener("change",h)}}function h(){for(let s=0;s<d.length;s++){const o=d[s],t=o.element,a=o.destination,i=o.place,v="_dynamic_adapt_"+o.breakpoint;if(p[s].matches){if(!t.classList.contains(v)){let b=u(a)[i];i==="first"?b=u(a)[0]:i==="last"&&(b=u(a)[u(a).length]),a.insertBefore(t,a.children[b]),t.classList.add(v)}}else t.classList.contains(v)&&(g(t),t.classList.remove(v))}}h();function g(s){const o=s.getAttribute("data-da-index"),t=l[o],a=t.parent,i=t.index,c=u(a,!0)[i];a.insertBefore(s,a.children[c])}function m(s){return Array.prototype.slice.call(s.parentNode.children).indexOf(s)}function u(s,o){const t=s.children,a=[];for(let i=0;i<t.length;i++){const c=t[i];(o||c.getAttribute("data-da")==null)&&a.push(i)}return a}function f(s){s.sort(function(o,t){return o.breakpoint>t.breakpoint?-1:1}),s.sort(function(o,t){return o.place>t.place?1:-1})}}function N(){const l=document.getElementById("bouquet-form"),r=document.getElementById("upload-area"),d=document.getElementById("bouquet-upload"),p=document.querySelector(".card__preview"),h=document.querySelector(".card__preview-image"),g=document.querySelector(".card__preview-change"),m=document.querySelector(".card__preview-remove"),u=document.getElementById("bouquet-wishes"),f=document.getElementById("char-count"),s=document.getElementById("file-data"),o=document.querySelector(".success-message"),t=document.querySelector(".error-message"),a=document.createElement("div");let i=null;a.className="card__progress-bar";const c=document.createElement("div");c.className="card__progress",c.appendChild(a),r.parentNode.insertBefore(c,r.nextSibling),u.addEventListener("input",function(){const e=this.value.length;f.textContent=e,e>500?(this.value=this.value.substring(0,500),f.textContent=500,f.style.color="#e74c3c"):e>450?f.style.color="#e74c3c":f.style.color="#333"}),r.addEventListener("click",function(e){e.target.closest(".card__preview-actions")||d.click()}),d.addEventListener("change",v),r.addEventListener("dragover",function(e){e.preventDefault(),r.classList.add("drag-over")}),r.addEventListener("dragleave",function(e){e.preventDefault(),r.classList.remove("drag-over")}),r.addEventListener("drop",function(e){e.preventDefault(),r.classList.remove("drag-over");const n=e.dataTransfer.files;if(n.length>0){const y=n[0];b(y)&&S(y)}}),g.addEventListener("click",function(){d.click()}),m.addEventListener("click",function(){E(),k()}),l.addEventListener("submit",function(e){if(e.preventDefault(),q(),!i&&!u.value.trim()){L("Пожалуйста, загрузите фото или напишите пожелания"),r.classList.add("error"),u.classList.add("error");return}r.classList.remove("error"),u.classList.remove("error");const n=new FormData(l);i&&n.append("bouquet_photo",i),n.append("timestamp",new Date().toISOString()),c.style.display="block",w(),_(n)});function v(e){const n=e.target.files[0];n&&b(n)&&S(n)}function b(e){return e.type.match("image.*")?e.size>10*1024*1024?(L("Изображение должно быть меньше 10MB"),!1):!0:(L("Пожалуйста, выберите изображение (JPG, PNG, GIF)"),!1)}function S(e){const n=new FileReader;n.onloadstart=function(){c.style.display="block"},n.onprogress=function(y){if(y.lengthComputable){const C=y.loaded/y.total*100;a.style.width=C+"%"}},n.onload=function(y){h.src=y.target.result,i=e,s.value=JSON.stringify({name:e.name,type:e.type,size:e.size,lastModified:e.lastModified}),p.style.display="block",r.style.display="none",c.style.display="none",B("✓ Фото успешно загружено!")},n.onerror=function(){L("Ошибка при чтении файла"),c.style.display="none"},n.readAsDataURL(e)}function E(){d.value="",h.src="",i=null,s.value="",p.style.display="none"}function k(){r.style.display="flex"}function _(e){fetch("/api/submit-bouquet-request",{method:"POST",body:e}).then(n=>n.json()).then(n=>{c.style.display="none",n.success?(A("Ваша заявка отправлена! Флорист свяжется с вами в течение 15 минут."),l.reset(),E(),k(),u.value="",f.textContent="0",f.style.color="#333"):L(n.message||"Ошибка при отправке формы")}).catch(n=>{c.style.display="none",L("Ошибка соединения. Пожалуйста, попробуйте еще раз."),console.error("Ошибка:",n)})}function w(){let e=0;const n=setInterval(()=>{e>=90?clearInterval(n):(e+=10,a.style.width=e+"%")},100)}function A(e){o.querySelector(".message-text").textContent=e,o.style.display="flex",t.style.display="none",setTimeout(()=>{o.style.display="none"},5e3)}function L(e){t.querySelector(".message-text").textContent=e,t.style.display="flex",o.style.display="none",setTimeout(()=>{t.style.display="none"},5e3)}function q(){o.style.display="none",t.style.display="none"}function B(e){const n=document.createElement("div");n.className="card__upload-success",n.innerHTML=e,n.style.display="block",p.parentNode.insertBefore(n,p.nextSibling),setTimeout(()=>{n.style.display="none"},3e3)}}function F(){const l=document.querySelector(".menu-list"),r=document.querySelectorAll(".burger-button"),d=document.querySelector(".page__menu-list"),p=document.querySelectorAll(".hamburger");l.querySelectorAll(".anchor-link").forEach(g=>{g.addEventListener("click",()=>{document.body.classList.toggle("no-scroll"),l.classList.contains("_open-list")&&(l.classList.remove("_open-list"),d.style.backgroundColor="transparent");for(let m=0;m<p.length;m++)p[m].classList.toggle("is-active")})}),r.forEach(g=>{g.addEventListener("click",()=>{const m=getComputedStyle(document.documentElement).getPropertyValue("--background-transparent");for(let u=0;u<p.length;u++)p[u].classList.toggle("is-active");l.classList.toggle("_open-list"),document.body.classList.toggle("no-scroll"),l.classList.contains("_open-list")?(d.style.backgroundColor=m,document.body.classList.add("no-scroll")):(document.body.classList.remove("no-scroll"),d.style.backgroundColor="transparent")})})}function O(){const l=document.querySelector(".header-container");document.querySelector(".search-button").addEventListener("click",()=>{l.classList.toggle("_active"),sectionTop&&(l.classList.contains("_active"),sectionTop.style.transition="padding-top 0.3s ease-in-out")})}const z=/Mobi|Android/i.test(navigator.userAgent);z||P();T(".preloader");O();F();D();showButton();document.addEventListener("DOMContentLoaded",()=>{N()});
