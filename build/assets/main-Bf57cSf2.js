import{g as T,a as w,b as D}from"./vendors/vendor-Cp5wc69_.js";function N(u){window.onload=function(){document.querySelector(u).classList.add("preloader-remove"),document.documentElement.classList.add("loaded")}}T.registerPlugin(w,D);function F(){w.create({wrapper:"#wrapper",content:"#content",speed:1,smooth:1,effects:!0,smoothTouch:.1})}function O(){let u=[],n=document.querySelectorAll("[data-da]"),i=[],g=[];if(n.length>0){let a=0;for(let s=0;s<n.length;s++){const t=n[s],c=t.getAttribute("data-da"),l=t.hasAttribute("data-da-position")?t.getAttribute("data-da-position"):"last",d=t.hasAttribute("data-da-resolution")?t.getAttribute("data-da-resolution"):768;t.setAttribute("data-da-index",a),u[a]={parent:t.parentNode,index:f(t)},i[a]={element:t,destination:document.querySelector("."+c),place:l,breakpoint:d},a++}y(i);for(let s=0;s<i.length;s++){const c=i[s].breakpoint,d=window.matchMedia(`(max-width: ${c}px)`);g.push(d),d.addEventListener("change",r)}}function r(){for(let a=0;a<i.length;a++){const s=i[a],t=s.element,c=s.destination,l=s.place,b="_dynamic_adapt_"+s.breakpoint;if(g[a].matches){if(!t.classList.contains(b)){let v=m(c)[l];l==="first"?v=m(c)[0]:l==="last"&&(v=m(c)[m(c).length]),c.insertBefore(t,c.children[v]),t.classList.add(b)}}else t.classList.contains(b)&&(p(t),t.classList.remove(b))}}r();function p(a){const s=a.getAttribute("data-da-index"),t=u[s],c=t.parent,l=t.index,d=m(c,!0)[l];c.insertBefore(a,c.children[d])}function f(a){return Array.prototype.slice.call(a.parentNode.children).indexOf(a)}function m(a,s){const t=a.children,c=[];for(let l=0;l<t.length;l++){const d=t[l];(s||d.getAttribute("data-da")==null)&&c.push(l)}return c}function y(a){a.sort(function(s,t){return s.breakpoint>t.breakpoint?-1:1}),a.sort(function(s,t){return s.place>t.place?1:-1})}}function z(){const u=document.querySelectorAll(".products-cart");let n=null;function i(r){if(!r)return;const p=r.querySelector(".products-cart__image"),f=r.querySelector(".products-cart__button-by");p.style.maxHeight="295px",f.style.marginTop="-57px",r.classList.remove("active"),n=null}function g(r){if(!r)return;const p=r.querySelector(".products-cart__image"),f=r.querySelector(".products-cart__button-by");p.style.maxHeight="235px",f.style.marginTop="0",r.classList.add("active"),n=r}document.addEventListener("click",r=>{if(r.target.closest(".products-cart__button-cart")||r.target.closest(".products-cart__button-by")||r.target.closest(".products-cart__link"))return;let f=!1;u.forEach(m=>{m.contains(r.target)&&(f=!0)}),!f&&n&&i(n)}),u.forEach(r=>{r.addEventListener("click",p=>{if(!(p.target.closest(".products-cart__button-cart")||p.target.closest(".products-cart__button-by")||p.target.closest(".products-cart__link"))){if(p.stopPropagation(),n===r){i(r);return}n&&i(n),g(r)}})})}function G(){const u=document.getElementById("bouquet-form"),n=document.getElementById("upload-area"),i=document.getElementById("bouquet-upload"),g=document.querySelector(".card__preview"),r=document.querySelector(".card__preview-image"),p=document.querySelector(".card__preview-change"),f=document.querySelector(".card__preview-remove"),m=document.getElementById("bouquet-wishes"),y=document.getElementById("char-count"),a=document.getElementById("file-data"),s=document.querySelector(".success-message"),t=document.querySelector(".error-message"),c=document.createElement("div");let l=null;c.className="card__progress-bar";const d=document.createElement("div");d.className="card__progress",d.appendChild(c),n.parentNode.insertBefore(d,n.nextSibling),m.addEventListener("input",function(){const e=this.value.length;y.textContent=e,e>500?(this.value=this.value.substring(0,500),y.textContent=500,y.style.color="#e74c3c"):e>450?y.style.color="#e74c3c":y.style.color="#333"}),n.addEventListener("click",function(e){e.target.closest(".card__preview-actions")||i.click()}),i.addEventListener("change",b),n.addEventListener("dragover",function(e){e.preventDefault(),n.classList.add("drag-over")}),n.addEventListener("dragleave",function(e){e.preventDefault(),n.classList.remove("drag-over")}),n.addEventListener("drop",function(e){e.preventDefault(),n.classList.remove("drag-over");const o=e.dataTransfer.files;if(o.length>0){const h=o[0];v(h)&&x(h)}}),p.addEventListener("click",function(){i.click()}),f.addEventListener("click",function(){k(),q()}),u.addEventListener("submit",function(e){if(e.preventDefault(),I(),!l&&!m.value.trim()){E("Пожалуйста, загрузите фото или напишите пожелания"),n.classList.add("error"),m.classList.add("error");return}n.classList.remove("error"),m.classList.remove("error");const o=new FormData(u);l&&o.append("bouquet_photo",l),o.append("timestamp",new Date().toISOString()),d.style.display="block",B(),A(o)});function b(e){const o=e.target.files[0];o&&v(o)&&x(o)}function v(e){return e.type.match("image.*")?e.size>10*1024*1024?(E("Изображение должно быть меньше 10MB"),!1):!0:(E("Пожалуйста, выберите изображение (JPG, PNG, GIF)"),!1)}function x(e){const o=new FileReader;o.onloadstart=function(){d.style.display="block"},o.onprogress=function(h){if(h.lengthComputable){const P=h.loaded/h.total*100;c.style.width=P+"%"}},o.onload=function(h){r.src=h.target.result,l=e,a.value=JSON.stringify({name:e.name,type:e.type,size:e.size,lastModified:e.lastModified}),g.style.display="block",n.style.display="none",d.style.display="none",M("✓ Фото успешно загружено!")},o.onerror=function(){E("Ошибка при чтении файла"),d.style.display="none"},o.readAsDataURL(e)}function k(){i.value="",r.src="",l=null,a.value="",g.style.display="none"}function q(){n.style.display="flex"}function A(e){fetch("/api/submit-bouquet-request",{method:"POST",body:e}).then(o=>o.json()).then(o=>{d.style.display="none",o.success?(C("Ваша заявка отправлена! Флорист свяжется с вами в течение 15 минут."),u.reset(),k(),q(),m.value="",y.textContent="0",y.style.color="#333"):E(o.message||"Ошибка при отправке формы")}).catch(o=>{d.style.display="none",E("Ошибка соединения. Пожалуйста, попробуйте еще раз."),console.error("Ошибка:",o)})}function B(){let e=0;const o=setInterval(()=>{e>=90?clearInterval(o):(e+=10,c.style.width=e+"%")},100)}function C(e){s.querySelector(".message-text").textContent=e,s.style.display="flex",t.style.display="none",setTimeout(()=>{s.style.display="none"},5e3)}function E(e){t.querySelector(".message-text").textContent=e,t.style.display="flex",s.style.display="none",setTimeout(()=>{t.style.display="none"},5e3)}function I(){s.style.display="none",t.style.display="none"}function M(e){const o=document.createElement("div");o.className="card__upload-success",o.innerHTML=e,o.style.display="block",g.parentNode.insertBefore(o,g.nextSibling),setTimeout(()=>{o.style.display="none"},3e3)}}const H=document.querySelector(".products-cart");document.querySelector(".products-cart__image");console.log(H);N(".preloader");const R=/Mobi|Android/i.test(navigator.userAgent);O();z();R||F();document.addEventListener("DOMContentLoaded",()=>{G()});const _=document.querySelector(".menu-list"),U=document.querySelectorAll(".burger-button"),S=document.querySelector(".page__menu-list"),L=document.querySelectorAll(".hamburger"),J=_.querySelectorAll(".anchor-link");J.forEach(u=>{u.addEventListener("click",()=>{document.body.classList.toggle("no-scroll"),_.classList.contains("_open-list")&&(_.classList.remove("_open-list"),S.style.backgroundColor="transparent");for(let n=0;n<L.length;n++)L[n].classList.toggle("is-active")})});U.forEach(u=>{u.addEventListener("click",()=>{const n=getComputedStyle(document.documentElement).getPropertyValue("--background-transparent");for(let i=0;i<L.length;i++)L[i].classList.toggle("is-active");_.classList.toggle("_open-list"),document.body.classList.toggle("no-scroll"),_.classList.contains("_open-list")?(S.style.backgroundColor=n,document.body.classList.add("no-scroll")):(document.body.classList.remove("no-scroll"),S.style.backgroundColor="transparent")})});
