import{g as I,a as M,b as C}from"./vendors/vendor-P3b2-r6N.js";I.registerPlugin(M,C);function D(){M.create({wrapper:"#wrapper",content:"#content",speed:1,smooth:1,effects:!0,smoothTouch:.1})}function P(){let m=[],i=document.querySelectorAll("[data-da]"),l=[],g=[];if(i.length>0){let a=0;for(let o=0;o<i.length;o++){const e=i[o],n=e.getAttribute("data-da"),r=e.hasAttribute("data-da-position")?e.getAttribute("data-da-position"):"last",c=e.hasAttribute("data-da-resolution")?e.getAttribute("data-da-resolution"):768;e.setAttribute("data-da-index",a),m[a]={parent:e.parentNode,index:f(e)},l[a]={element:e,destination:document.querySelector("."+n),place:r,breakpoint:c},a++}u(l);for(let o=0;o<l.length;o++){const n=l[o].breakpoint,c=window.matchMedia(`(max-width: ${n}px)`);g.push(c),c.addEventListener("change",h)}}function h(){for(let a=0;a<l.length;a++){const o=l[a],e=o.element,n=o.destination,r=o.place,v="_dynamic_adapt_"+o.breakpoint;if(g[a].matches){if(!e.classList.contains(v)){let b=d(n)[r];r==="first"?b=d(n)[0]:r==="last"&&(b=d(n)[d(n).length]),n.insertBefore(e,n.children[b]),e.classList.add(v)}}else e.classList.contains(v)&&(p(e),e.classList.remove(v))}}h();function p(a){const o=a.getAttribute("data-da-index"),e=m[o],n=e.parent,r=e.index,c=d(n,!0)[r];n.insertBefore(a,n.children[c])}function f(a){return Array.prototype.slice.call(a.parentNode.children).indexOf(a)}function d(a,o){const e=a.children,n=[];for(let r=0;r<e.length;r++){const c=e[r];(o||c.getAttribute("data-da")==null)&&n.push(r)}return n}function u(a){a.sort(function(o,e){return o.breakpoint>e.breakpoint?-1:1}),a.sort(function(o,e){return o.place>e.place?1:-1})}}function T(){const m=document.getElementById("bouquet-form"),i=document.getElementById("upload-area"),l=document.getElementById("bouquet-upload"),g=document.querySelector(".card__preview"),h=document.querySelector(".card__preview-image"),p=document.querySelector(".card__preview-change"),f=document.querySelector(".card__preview-remove"),d=document.getElementById("bouquet-wishes"),u=document.getElementById("char-count"),a=document.getElementById("file-data"),o=document.querySelector(".success-message"),e=document.querySelector(".error-message"),n=document.createElement("div");let r=null;n.className="card__progress-bar";const c=document.createElement("div");c.className="card__progress",c.appendChild(n),i.parentNode.insertBefore(c,i.nextSibling),d.addEventListener("input",function(){const t=this.value.length;u.textContent=t,t>500?(this.value=this.value.substring(0,500),u.textContent=500,u.style.color="#e74c3c"):t>450?u.style.color="#e74c3c":u.style.color="#333"}),i.addEventListener("click",function(t){t.target.closest(".card__preview-actions")||l.click()}),l.addEventListener("change",v),i.addEventListener("dragover",function(t){t.preventDefault(),i.classList.add("drag-over")}),i.addEventListener("dragleave",function(t){t.preventDefault(),i.classList.remove("drag-over")}),i.addEventListener("drop",function(t){t.preventDefault(),i.classList.remove("drag-over");const s=t.dataTransfer.files;if(s.length>0){const y=s[0];b(y)&&L(y)}}),p.addEventListener("click",function(){l.click()}),f.addEventListener("click",function(){E(),w()}),m.addEventListener("submit",function(t){if(t.preventDefault(),A(),!r&&!d.value.trim()){x("Пожалуйста, загрузите фото или напишите пожелания"),i.classList.add("error"),d.classList.add("error");return}i.classList.remove("error"),d.classList.remove("error");const s=new FormData(m);r&&s.append("bouquet_photo",r),s.append("timestamp",new Date().toISOString()),c.style.display="block",_(),S(s)});function v(t){const s=t.target.files[0];s&&b(s)&&L(s)}function b(t){return t.type.match("image.*")?t.size>10*1024*1024?(x("Изображение должно быть меньше 10MB"),!1):!0:(x("Пожалуйста, выберите изображение (JPG, PNG, GIF)"),!1)}function L(t){const s=new FileReader;s.onloadstart=function(){c.style.display="block"},s.onprogress=function(y){if(y.lengthComputable){const q=y.loaded/y.total*100;n.style.width=q+"%"}},s.onload=function(y){h.src=y.target.result,r=t,a.value=JSON.stringify({name:t.name,type:t.type,size:t.size,lastModified:t.lastModified}),g.style.display="block",i.style.display="none",c.style.display="none",B("✓ Фото успешно загружено!")},s.onerror=function(){x("Ошибка при чтении файла"),c.style.display="none"},s.readAsDataURL(t)}function E(){l.value="",h.src="",r=null,a.value="",g.style.display="none"}function w(){i.style.display="flex"}function S(t){fetch("/api/submit-bouquet-request",{method:"POST",body:t}).then(s=>s.json()).then(s=>{c.style.display="none",s.success?(k("Ваша заявка отправлена! Флорист свяжется с вами в течение 15 минут."),m.reset(),E(),w(),d.value="",u.textContent="0",u.style.color="#333"):x(s.message||"Ошибка при отправке формы")}).catch(s=>{c.style.display="none",x("Ошибка соединения. Пожалуйста, попробуйте еще раз."),console.error("Ошибка:",s)})}function _(){let t=0;const s=setInterval(()=>{t>=90?clearInterval(s):(t+=10,n.style.width=t+"%")},100)}function k(t){o.querySelector(".message-text").textContent=t,o.style.display="flex",e.style.display="none",setTimeout(()=>{o.style.display="none"},5e3)}function x(t){e.querySelector(".message-text").textContent=t,e.style.display="flex",o.style.display="none",setTimeout(()=>{e.style.display="none"},5e3)}function A(){o.style.display="none",e.style.display="none"}function B(t){const s=document.createElement("div");s.className="card__upload-success",s.innerHTML=t,s.style.display="block",g.parentNode.insertBefore(s,g.nextSibling),setTimeout(()=>{s.style.display="none"},3e3)}}document.querySelector(".page__header");const N=/Mobi|Android/i.test(navigator.userAgent);P();N||D();document.addEventListener("DOMContentLoaded",()=>{T()});document.addEventListener("DOMContentLoaded",()=>{const m=document.querySelector(".section-map__image-map"),i=m.querySelector(".draggable-img");let l=!1,g=0,h=0,p=0,f=0,d=0,u=0;i.complete?a():i.onload=a,window.addEventListener("resize",a);function a(){const e=m.getBoundingClientRect(),n=i.getBoundingClientRect();d=e.width-n.width,u=e.height-n.height,d>0&&(d=0),u>0&&(u=0),p=Math.max(d,Math.min(0,p)),f=Math.max(u,Math.min(0,f)),o()}function o(){i.style.transform=`translate(${p}px, ${f}px)`}m.addEventListener("mousedown",e=>{l=!0,m.classList.add("grabbing"),g=e.clientX-p,h=e.clientY-f}),window.addEventListener("mouseup",()=>{l=!1,m.classList.remove("grabbing")}),window.addEventListener("mousemove",e=>{l&&(p=e.clientX-g,f=e.clientY-h,p=Math.max(d,Math.min(0,p)),f=Math.max(u,Math.min(0,f)),o())}),m.addEventListener("touchstart",e=>{const n=e.touches[0];l=!0,g=n.clientX-p,h=n.clientY-f},{passive:!0}),m.addEventListener("touchend",()=>{l=!1}),m.addEventListener("touchmove",e=>{if(!l)return;const n=e.touches[0];p=n.clientX-g,f=n.clientY-h,p=Math.max(d,Math.min(0,p)),f=Math.max(u,Math.min(0,f)),o()},{passive:!0}),i.addEventListener("dragstart",e=>e.preventDefault())});console.log("%c РОССИЯ ","background: blue; color: yellow; font-size: x-large; border-left: 5px solid black; border-top: 30px solid white; border-right: 2px solid black; border-bottom: 30px solid red;");
